<% include ../partials/header %>


<div class="container offer main">
    
    
    <div class="title">
        <h1> 
            <%= post.title %>
        </h1>
        
        <p class="empl">
            <strong>Employer:</strong> <%= post.author %>
        </p>
    </div>
    <p class="descr">
        <%= post.descr %>
    </p>
    
    <p class="budget">
        Budget: <%= post.price %> PLN
    </p>
    
    
    <!--<button class="btn" onclick="window.location.href='/offers'">Go back</button>-->
    
    

    
</div>
<div class="container main">
    <ul class="comments">
            <% if(post.comments.length != 0){
              post.comments.forEach(function(comment){ %>
               <li  class="comment"> 
               <span class="av-placeholder">avatar holder</span>
               <a href="#" class="author"> <%= comment.author %> </a>
               <p id="date"> <%= timeSince(comment.date) %><p></p>
               <p class="context"> <%= comment.context %></p>
               <p class="off-price"> Price-placeholder</p>
               </li>
            <% }); 
            } else {%>
            <li  class="comment">
                <p class="context">No one placed an offer yet</p>
            </li>
            <% } %>
    </ul>
    <% if (status == true){ %>
        <form action="/offers/<%= post._id %>/comments" method="POST">
            <textarea name="context" placeholder="Comment..." required pattern=".{5,}" title="Comment should be longer than 5 characters"></textarea>
            <button class="submit">Bid on this!</button>
            <input type="number" min="0.00" id="price-form" placeholder="price">
        </form>
    <% } %>
</div>

<%
    function timeSince(date) {

      var seconds = Math.floor((new Date() - date) / 1000);
    
      var interval = Math.floor(seconds / 31536000);
    
      if (interval > 1) {
        return interval + " years ago";
      }
      interval = Math.floor(seconds / 2592000);
      if (interval > 1) {
        return interval + " months ago";
      }
      interval = Math.floor(seconds / 86400);
      if (interval > 1) {
        return interval + " days ago";
      }
      interval = Math.floor(seconds / 3600);
      if (interval > 1) {
        return interval + " hours ago";
      }
      interval = Math.floor(seconds / 60);
      if (interval > 1) {
        return interval + " minutes ago";
      }
      return Math.floor(seconds) + " seconds ago";
    }
 %>

<% include ../partials/footer %>